#USING GROUP_BY and SUMMARISE
#checking for column names
names(fish)
#grouping by parcel.end/start.time and assigning function to "maximum"
maximum <- group_by(fish,parcel.end.time,parcel.start.time)
#summarise
summarise(maximum,max.peo=max(parcel.end.lon),min.peo=min(parcel.end.lon),med.peo=median(parcel.end.lon),upper95.peo=quantile(parcel.end.lon,.05),lower95.peo=quantile(parcel.end.lon,.95))


#USING MERGE
#creating dataframe for maximum values
max <- tapply(X = fish$parcel.end.time,INDEX = fish$parcel.end.lat,FUN = max)
maximum<-data.frame(max)
maximum$max.p <- rownames(maximum)
#creating dataframe for miniumum values
min <- tapply(X = fish$parcel.end.time,INDEX = fish$parcel.end.lat,FUN = min)
minimum <- data.frame(min)
minimum$min.p <- rownames(minimum)
#merging by.x and by.y
max.min <- merge(x = maximum,y = minimum,by.x = "max.p",by.y = "min.p")
max.min
              max.p        max        min
1   24.3082333333333 1434998147 1434998147
2   24.3117833333333 1434979478 1434979478
3   24.3193239512518 1434976177 1434976177


#USING JOIN
#renaming rownames to "parcel.end.lat"
maximum <- rename(maximum,parcel.end.lat=max.p)
minimum <- rename(minimum,parcel.end.lat=min.p)
#joining max and min by parcel.end.lat
max.min.ij <- inner_join(x = maximum,y = minimum,"parcel.end.lat")
#reorganizing columns
max.min.ij<-max.min.ij[,c("parcel.end.lat","max","min")]
max.min.ij
      parcel.end.lat        max        min
1   24.3082333333333 1434998147 1434998147
2   24.3117833333333 1434979478 1434979478
3   24.3193239512518 1434976177 1434976177